<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>最短滞在日数計算機テスト</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    label { display: block; margin-top: 10px; }
    input, select { width: 200px; padding: 5px; }
    #result { margin-top: 20px; font-weight: bold; }
  </style>
</head>
<body>
  <h1>最短滞在日数計算機</h1>

  <label>交通費（往復）:
    <input type="number" id="transportCost" value="100000">
  </label>

  <label>宿泊費（一泊）:
    <input type="number" id="hotelCost" value="15000">
  </label>

  <label>判定方法:
    <select id="methodSelect" onchange="toggleTargetInput()">
      <option value="rate">減少率の鈍化</option>
      <option value="target">任意の1日あたり費用以下</option>
    </select>
  </label>

  <label id="targetCostLabel" style="display: none;">目標1日あたり費用（円）:
    <input type="number" id="targetCost">
  </label>

  <button onclick="calculate()">計算</button>

  <div id="result"></div>

  <script>
    function toggleTargetInput() {
      const method = document.getElementById("methodSelect").value;
      document.getElementById("targetCostLabel").style.display = method === "target" ? "block" : "none";
    }

    function calculate() {
      const transport = Number(document.getElementById("transportCost").value);
      const hotel = Number(document.getElementById("hotelCost").value);
      const method = document.getElementById("methodSelect").value;
      const target = Number(document.getElementById("targetCost").value);

      let suggestedStay = null;
      const maxDays = 30;
      let resultText = "";

      for (let days = 1; days <= maxDays; days++) {
        const totalCost = transport + hotel * days;
        const perDay = totalCost / days;

        if (method === "target") {
          if (perDay <= target) {
            suggestedStay = days;
            break;
          }
        } else if (method === "rate") {
          const prevTotal = transport + hotel * (days - 1);
          const prevPerDay = days > 1 ? prevTotal / (days - 1) : Infinity;
          const drop = prevPerDay - perDay;
          if (drop < 5000 && days > 1) {
            suggestedStay = days;
            break;
          }
        }
      }

      if (suggestedStay) {
        resultText = `おすすめの最短滞在日数は ${suggestedStay} 泊です。`;
      } else {
        resultText = "30泊以内では条件に合う日数が見つかりませんでした。";
      }

      document.getElementById("result").innerText = resultText;
    }
  </script>
</body>
</html>
